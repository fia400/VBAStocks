Sub Vol()

  ' Set an initial variable for Ticker
    Dim Ticker_ As String

  ' Set an initial variable for holding the total per Volume
    Dim Vol_Total As Double
    Vol_Total = 0
  
  ' Keep track of the location for each Ticker in the summary table
    Dim Summary_Table_Row As Integer
    Summary_Table_Row = 2

    Dim IRow As Long
    
    'Find the last non-blank cell in column A(1)
   IRow = Cells(Rows.Count, 1).End(xlUp).Row

  
    ' Loop through the values in Ticker Symbol
    For i = 2 To IRow
 
     ' Check if we are still within the same Ticker, if it is not...
    If Cells(i + 1, 1).Value <> Cells(i, 1).Value Then

          ' Set the Ticker name
          Ticker_ = Cells(i, 1).Value
    
          ' Add to the Volume Total
          Vol_Total = Vol_Total + Cells(i, 7).Value
    
          ' Print the Ticker in the Summary Table
          Range("I" & Summary_Table_Row).Value = Ticker_
    
          ' Print the Volume Sum to the Summary Table
          Range("L" & Summary_Table_Row).Value = Vol_Total
    
          ' Add one to the summary table row
          Summary_Table_Row = Summary_Table_Row + 1
          
          ' Reset the Vol Total
          Vol_Total = 0
          
       ' If the cell immediately following a row is the same brand...
        Else
    
          ' Add to the Vol Total
          Vol_Total = Vol_Total + Cells(i, 3).Value

        End If
        

        Next i
    
    End Sub

' -----------------------------------

    Sub YrChange()

  ' Set an initial variable for Ticker
    Dim Ticker_ As String
    Dim Open_ as Double
    Dim Close_ as Double

  ' Set an initial variable for holding the total per Volume
    Dim YrCh_Total As Double
    YrCh_Total = 0

    Dim IRow As Long
    
    'Find the last non-blank cell in column 10
    IRow = Cells(Rows.Count, 10).End(xlUp).Row
  
  ' Keep track of the location for each Ticker in the summary table
    Dim Summary_Table_Row As Integer
    Summary_Table_Row = 2
  
    ' Loop through the values in Ticker Symbol
    For i = 2 To IRow
 
     ' Check if we are still within the same Ticker, if it is not...
    If Cells(i + 1, 1).Value <> Cells(i, 1).Value Then

          ' Set the Ticker name
          Ticker_ = Cells(i, 1).Value
    
          ' Divide open by close
          YrCh_Total = Cells(i,3) / Cells(i,6).Value
    
          ' Print the Sum YrChange to the Summary Table
          Range("J" & Summary_Table_Row).Value = YrCh
    
          ' Add one to the summary table row
          Summary_Table_Row = Summary_Table_Row + 1
          
          ' Reset the Year Change %
          YrCh = 0
          
       ' If the cell immediately following a row is the same brand...
        Else
    
          ' Add to the Year Change
          YrCh = YrCh / Cells(i, 6).Value

        End If
        

        Next i
    
    End Sub
' -------------------------------

Sub formatter()

  Dim i, j As Integer
  cellnumber = 1

    Dim IRow As Long
    
    'Find the last non-blank cell in column 10
    IRow = Cells(Rows.Count, 8).End(xlUp).Row


    ' Loop through each row 
  For i = 1 to IRow

    ' Loop through each column 
    For j = 8 to 8

  ' Check if the % is positive...
     If Cells(i, 8).Value > 0 Then

      ' Color green
         Cells(i, 8).Interior.ColorIndex = 4

    Else
      ' Else color red
       Cells(i, 8).Value = <=-1 Then

      ' Color the red
      Cells(i, 8).Interior.ColorIndex = 3

    End if
        
        Next j

      Next i


End Sub


